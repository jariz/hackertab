<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../bower_components/core-transition/core-transition.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/core-toolbar/core-toolbar.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../bower_components/paper-progress/paper-progress.html">
<polymer-element name="item-column" attributes="column">
    <template>
        <style>
            :host {
                display:block;
                min-width:250px;
                height:50%;
            }

            .card {
                background: #fff;
                border-radius: 3px;
                margin: 15px 10px;
                height: calc(100% - 30px);
                box-sizing: border-box;
                position: relative;
                padding-top:64px;
            }

            paper-icon-button {
                background-size: cover;
            }

            paper-icon-button.core-transition:not(.core-opened):not(.core-closed) {
                visibility: hidden;
            }

            paper-spinner {
                top: 50%;
                left: 50%;
                position: absolute;
            }

            paper-spinner::shadow .circle {
                border-color: rgb({{column.color[0]}}, {{column.color[1]}}, {{column.color[2]}});
            }

            paper-progress::shadow #activeProgress, core-toolbar  {
                background-color: rgb({{column.color[0]}}, {{column.color[1]}}, {{column.color[2]}});
            }

            paper-progress {
                position:absolute;
                top:64px;
                width:100%;
                opacity: 0;
                transition:500ms opacity;
            }

            core-toolbar {
                position: absolute;
                width: 100%;
                top: 0;
                left: 0;
                color: #f1f1f1;
                /*z-index: 100;*/
            }

            core-toolbar.draggable {
                cursor: move;
                cursor: -webkit-grabbing;
            }

            .holder {
               max-height:100%;
                width:100%;
                box-sizing: border-box;
                padding-left: 14px;
                transform: translateX(-14px) translateZ(0);
            }

            .holder0 {
                overflow: hidden;
            }
            
            .holder0:hover .holder1, .holder0:hover .holder, .holder0:focus .holder1, .holder0:focus .holder {
                transform: translateX(0) translateZ(0);
            }

            .holder1, .holder {
                transition: transform 400ms ease;
            }

            .holder1 {
                overflow-y: scroll;
                height: 100%;
                transform: translateX(14px) translateZ(0);
            }

            .holder > * {
                width:100%;
                display:block;
            }

            .holder.flex {
                display:flex;
                flex-wrap: wrap;
                align-content: flex-start;
                justify-content: center;
            }

            .holder .hack {
                height: 0;
                border: none;
                padding: 0;
                overflow: hidden;
            }

            .handle {
                position: absolute;
                bottom:0;
                right:0;
                width: 17px;
                height: 19px;
                cursor:se-resize;
                visibility: hidden;
            }

            core-toolbar.draggable .title {
                overflow:hidden;
                text-overflow: ellipsis;
            }

            .handle core-icon {
                transform: rotate(-45deg);
            }

            /* Title link */
            .title a {
                color: inherit;
                text-decoration: none;
            }

            .logo {
                color:#fff;
            }
        </style>

        <paper-shadow class="card" z="1">
            <core-toolbar class="{{column.className}}">
                <template if="{{column.thumb}}">
                    <a target="_blank" href="{{column.link}}">
                        <paper-icon-button style="background-image: url(img/{{column.thumb}})" class="logo"></paper-icon-button>
                    </a>
                </template>
                <div class="title" flex><a target="_blank" href="{{column.link}}">{{column.name}}</a></div>
                <paper-icon-button on-click="{{_delete}}" icon="delete" class="editable" hidden></paper-icon-button>
                <paper-icon-button on-click="{{settings}}" icon="settings" class="editable settings" hidden></paper-icon-button>
                <paper-icon-button on-click="{{refresh}}" icon="refresh"></paper-icon-button>
            </core-toolbar>

            <paper-progress indeterminate></paper-progress>

            <paper-spinner class="{{column.className}}" active></paper-spinner>
            <div class="holder0">
            <div class="holder1">
            <div class="holder">
            </div>
            </div>
            </div>

            <div class="handle">
                <core-icon icon="arrow-drop-down"></core-icon>
            </div>
        </paper-shadow>

    </template>
    <script>
        Polymer({
            _delete: function(e) {
                this.fire("column-delete", e.target.templateInstance.model.column);
            },
            settings: function(e) {
                this.fire("column-settings", e.target.templateInstance.model.column);
            },
            refresh: function(e) {
                this.fire("column-refresh", e.target.templateInstance.model.column);
            }
        });
    </script>
</polymer-element>